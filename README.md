# Wordpress installation in AWS
Створення інфраструктури AWS, а також, встановлення статичного сайту Wordpress. Інфраструктура складається з наступних компонентів:
* VPC (1 публічна і 2 приватні підмережі);
* EC2 Instance;
* RDS MySQL instance;
* ElastiCache Redis.

## Prerequisites
Перед початком, переконайтесь, що виконуються наступні вимоги:
* встановлено Terraform версії 1.0 і/або більше;
* встановлено AWS CLI;
* акаунт у AWS та відповідні облікові дані.

## Розгортання інфраструктури AWS
Для того, щоб підняти інфраструктуру в AWS, у файлі terraform.tfvars треба вказати шлях до публічного ключа. Дана дія необхідна для того, щоб мати можливість підключатись до віртуальної машини.

Якщо відсутня пара ключів (публічний і приватний), можна локально згенерувати пару за допомогою команди:
````
ssh-keygen
````
та після цього вказати шлях до публічного ключа у файлі terraform.tfvars

Для ініціалізації Terraform виконуємо наступну команду:
````
terraform init
````
Перевіряємо, які саме ресурси будуть створені командою:
````
terraform plan
````
Створюємо інфраструктуру виконавши наступну команду:
````
terraform apply
````
Буде створена інфраструктура із значеннями за замовчуванням.

Якщо необхідно змінити будь-яке значення (наприклад, регіон), можна:
* або змінити значення у файлі terraform.tfvars
* або замінити дефолтні значення у файлі variables.tf (тут надано більш розширений опис кожної змінної, в той час, коли у файлі terraform.tfvars надаються лише значення).

## Автоматична інсталяція Wordpress
Після створення інфраструктури в AWS, в outputs буде отримано значення публічної IP адреси для EC2 інстанса та ендпоінти для MySQL RDS і ElastiCache Redis відповідно.

Скрипт із встановленням Wordpress знаходиться у файлі з назвою wordpress.sh

Значення, які вказані у змінних, відповідають вказаним за замовчуванням значенням у файлі variables.tf, тому, для коректного виконання скрипта треба переконатись, що значення вказані у змінних скрипта відповідають дефолтним (або визначеним у файлі terraform.tfvars) значенням.

Потрібно вказати значення з outputs у відповідні змінні скрипта (EC2_HOST, DB_HOST, WP_REDIS_HOST)

Потрібно залогінитись на EC2 Instance за допомогою SSH ключа, який створено при піднятті інфраструктури.
За допомогою будь-якого редактора, або командою scp скопіювати файл скрипта на сервер EC2 і додати йому повноваження на виконання:
````
sudo chmod +x wordpress.sh
````
Запустити скрипт (з поточної директорії, куди скопійовано скрипт):
````
./script.sh
````
Установка Wordpress завершена. Перевірити коректність роботи можна перейшовши за вказаною у скрипті URL адресою (наприклад, http://EC2_HOST/wp-login.php). Логін і пароль вказані прямо у скрипті при інсталяції Wordpress (можна змінити на власні за бажанням).
Так як сайт піднято і ми можемо залогінитись, відповідно база даних працює. Перевірити коректність роботи Redis можна перейшовши у вкладку Plugins > Installed Plugins.